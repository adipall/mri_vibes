% addpath /scratch/dmday/code/Salinas/tools/matlab/loadExodusIntoMatlab
name = 'myFrustum.e';
fexo=exo_rd(name);
time = 0.;
chkTime(fexo,time);
x0 = fexo.Nodes.Coordinates(:,1);
y0 = fexo.Nodes.Coordinates(:,2);
theta = atan2(y0,x0);
blkidx = 1;
nodes = fexo.Blocks(1,1).Connectivity(:,blkidx);
angles = theta(nodes);
clear nodes theta y0 x0
varname = 'layer_temp1';
data = (1 + cos(angles))*100;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp2';
data = (1 + cos(angles))*200;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp3';
data = (1 + cos(angles))*300;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp4';
data = (1 + cos(angles))*400;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp5';
data = (1 + cos(angles))*500;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp6';
data = (1 + cos(angles))*600;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp7';
data = (1 + cos(angles))*700;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp8';
data = (1 + cos(angles))*800;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp9';
data = (1 + cos(angles))*800;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp10';
data = (1 + cos(angles))*700;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp11';
data = (1 + cos(angles))*600;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp12';
data = (1 + cos(angles))*500;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp13';
data = (1 + cos(angles))*400;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp14';
data = (1 + cos(angles))*300;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp15';
data = (1 + cos(angles))*200;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
varname = 'layer_temp16';
data = (1 + cos(angles))*100;
fexo=AddElemVar(fexo,varname,blkidx,data,time);
exo_put('frustum.exo',fexo);
